import
	crow/io/print: out, print
	crow/private/thread-utils: count-processors

main nat^(_ string[]) summon
	out print "running with {trusted count-processors} processors"
	p nat64 range parallel-collection = (1_000_000 .. 1_010_000).parallel
	primes nat[] <- p filter x => x.is-prime,
	out print "primes: {(for x : primes; x.to)::json[].to::json}"
	()

is-prime bool(a nat)
	!(2 .. a exists x => a is-multiple-of x)
