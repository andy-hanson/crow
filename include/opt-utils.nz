import
	.bootstrap: call fun-mut0 fun-mut1 none opt value
	.exceptions: fail

opt-or ?t(a opt ?t, default fun-mut0 ?t)
	match a
	as none n
		default call
	as some s
		s value

force ?t(a opt ?t)
	match a
	as none n
		fail: "tried to force empty option"
	as some s
		s value

then opt ?out(a opt ?in, f fun-mut1 opt<?out> ?in)
	match a
	as none n
		none
	as some s
		f call s.value
