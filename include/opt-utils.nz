import
	.bootstrap: call none opt some value
	.exceptions: fail

opt-map opt ?out(a opt ?in, cb act ?out(?in))
	match a
	as none
		none
	as some s
		cb call s.value some

opt-or ?t(a opt ?t, default act ?t())
	match a
	as none
		default call
	as some s
		s value

force ?t(a opt ?t)
	match a
	as none
		fail: "tried to force empty option"
	as some s
		s value
