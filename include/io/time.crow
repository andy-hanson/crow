no-std
import
	..fut: fut
	..fut-low-level: resolve!, unresolved
	..misc: void
	..number: +, *, nat
	..runtime: add-task, get-cur-island, new-exclusion
	.time-low-level: get-monotime-nsec

duration record
	nsec nat

msec duration(a nat)
	duration: a * 1000000

delay fut void(duration duration) trusted summon
	target-time = get-monotime-nsec + duration.nsec
	island = get-cur-island
	res = unresolved<void>
	island add-task target-time, island.new-exclusion, \
		res resolve! void
	res
