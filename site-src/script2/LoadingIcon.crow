import
	crow/js: as-js, as-t, call-property, get, js-global
	./util/js-util: make-class, method, to-js-object
	./util/util: create-div, node, set-style-sheet

define-loading-icon-element void() trusted, js extern
	ctor method = (this, _) =>
		root = this call-property "attachShadow", (("mode", "open"::string.as-js),).to-js-object
		root.as-t set-style-sheet css as-js
	connectedCallback method = (this, _) =>
		this get "shadowRoot" call-property "append", loading-div
	cls = "HTMLElement".js-global make-class ctor, (("connectedCallback", connectedCallback),)
	_ = "customElements".js-global call-property "define", "crow-loading-spinner"::string, cls

create-loading-icon node() trusted, js extern
	"document".js-global call-property "createElement", "crow-loading-spinner"::string as-t

-loading-div node() js extern
	"root" create-div for class-name : ("child-0", "child-1", "child-2", "child-3")::string[]
		class-name create-div

-css string()
	"""
.root \{
	display: inline-block;
	position: relative;
	height: 2em;
}
.child-0, .child-1, .child-2, .child-3 \{
	position: absolute;
	top: 0.75em;
	width: 0.666em;
	height: 0.666em;
	border-radius: 50%;
	background: #ab9df2;
	animation-timing-function: cubic-bezier(0, 1, 1, 0);
}
.child-0 \{ left: 1em; animation: ani0 0.8s infinite; }
.child-1 \{ left: 1em; animation: ani1 0.8s infinite; }
.child-2 \{ left: 2em; animation: ani1 0.8s infinite; }
.child-3 \{ left: 3em; animation: ani2 0.8s infinite; }
@keyframes ani0 \{
	0% \{ transform: scale(0); }
	100% \{ transform: scale(1); }
}
@keyframes ani1 \{
	0% \{ transform: translate(0, 0); }
	100% \{ transform: translate(1em, 0); }
}
@keyframes ani2 \{
	0% \{ transform: scale(1); }
	100% \{ transform: scale(0); }
}
"""
