<section>
	<h2>declare a union</h2>
	<p>
		While a record stores multiple fields, a union stores exactly one of several possible values.
		<br />
		Unlike a union in C, unions in crow are <em>discriminated</em>,
		meaning a union knows which of the possible values it stores.
	</p>
	<p>
		A <code class="keyword">union</code> is similar to an <code class="keyword">enum</code>,
		except that each member may have an associated value.
	</p>
	<crow-runnable>
		main nat^(_ string[]) summon
			info log "crow".describe
			info log "dr. mario".describe
			info log "soap".describe
			()

		entity union
			bird bird
			doctor string
			unknown

		bird enum
			crow
			seagull

		describe string(a string)
			"{a}: {a.parse greet}"

		parse entity(a string)
			if d ?= a try-remove-start "dr. "
				d doctor
			elif b ?= a.to::bird?
				b bird
			else
				unknown

		greet string(a entity)
			match a
			as bird b
				"hello, you {b}"
			as doctor d
				"greetings, doctor {d}"
			as unknown
				"don't know what to do with this"
	</crow-runnable>
	<p>
		This defines a union <code class="struct">entity</code>.
		<br />
		Declaring the union also declares functions <code class="fun">bird</code>,
		<code class="fun">doctor</code>, and <code class="fun">unknown</code> for creating members of the union.
	</p>
</section>
<section>
	<h2>construct a union value</h2>
	<p>
		When a union member has a type, the associated function takes an argument;
		<code class="fun">bird</code> takes a <code class="struct">bird</code> and
		<code class="fun">doctor</code> takes a <code class="struct">str</code>.
		<br />
		<code class="fun">unknown</code> takes no argument, just like an enum member.
	</p>

</section>
<section>
	<h2>match</h2>
	<p>
		<code class="keyword">match</code> works like for enums,
		but also gets you the value associated with each union member.
	</p>
	<p>
		<code>as doctor d</code> declares a local <code class="local">d</code>
		that is in scope for the indented block below it.
		<br />
		It's of type <code class="struct">str</code> since that's the type of the union member <code>doctor</code>.
	</p>
	<p>
		Like for enums, the branches of a <code class="keyword">match</code> must have the same order
		as the members of the union, and there can't be missing branches.
	</p>
</section>
