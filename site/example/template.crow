import
	crow/io/print: print

main fut nat(_ str[]) summon
	nats = 1 node<nat> (2 node (3 node none).some).some
	floats = 1.1 node<float> (2.2 node none).some
	print: "nats size: {nats size}"
	print: "nats sum: {nats sum}"
	print: "floats size: {floats size}"
	print: "floats sum: {floats sum}"
	0 resolved

node<a> record
	head a
	tail node<a>?

size<a> nat(a node a)
	1 size a.tail

size<a> nat(acc nat, a node<a>?)
	if node ?= a
		acc + 1 size node.tail
	else
		acc

plus<a> spec
	+ a(a a, b a)

sum<a> a(a node a) plus<a>
	a.head sum a.tail

sum<a> a(acc a, a node<a>?) plus<a>
	if node ?= a
		acc + node.head sum node.tail
	else
		acc
